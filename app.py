import streamlit as st
import openai

# Set up the page configuration
st.set_page_config(page_title="GPT-3.5 Turbo and DALL-E App", page_icon="ğŸ¤–", layout="wide")

# Define a function to get the GPT-3.5 response
@st.cache_data
def get_gpt_response(api_key, question):
    openai.api_key = api_key
    response = openai.Completion.create(
        engine="davinci",
        prompt=question,
        max_tokens=150
    )
    return response.choices[0].text.strip()

# Define a function to get the DALL-E image URL
@st.cache_data
def get_dalle_image(api_key, prompt):
    openai.api_key = api_key
    response = openai.Image.create(
        prompt=prompt,
        n=1,
        size="512x512"
    )
    return response['data'][0]['url']

# Sidebar for navigation
page = st.sidebar.selectbox("Select a page", ["GPT-3.5 Chatbot", "DALL-E Image Generator"])

# Common API key input
api_key = st.sidebar.text_input("OpenAI API Key", type="password")
if api_key:
    st.session_state["api_key"] = api_key

# Page 1: GPT-3.5 Chatbot
if page == "GPT-3.5 Chatbot":
    st.title("35ì‚´ ê¸ˆíƒœì–‘ ë©”ì´ìŠ¨")
    st.write("ì–´ì´.ë‹ˆ ë§ˆìŒì˜ ë¹„ë°€ë²ˆí˜¸ëŠ” ë­ëƒ? ë°”ë³´ëƒ APIí‚¤ ë§ì´ì•¼.")
    
    question = st.text_input("ê·¸ë˜ì„œ ë¬¼ì–´ë³´ê³  ì‹¶ì€ê²Œ ë­”ë°")
    
    if question:
        if "api_key" in st.session_state:
            response = get_gpt_response(st.session_state["api_key"], question)
            st.write("Response from GPT-3.5 Turbo:")
            st.write(response)
        else:
            st.write("ë‚´ ìƒê°ì—ëŠ” ë„ˆ ë¹„ë°€ë²ˆí˜¸ ì˜ëª» ì…ë ¥í•œê²ƒ ê°™ì•„.")
    
# Page 2: DALL-E Image Generator
elif page == "DALL-E Image Generator":
    st.title("ì§€ì¹œ ê·¸ë¦¼ ê³ ì–‘ì´ ë‹¬ì´")
    st.write("ì•ˆëƒ¥... APIí‚¤ë‘ ì–´ë–¤ ê·¸ë¦¼ì„ ê·¸ë¦¬ê³  ì‹¶ì€ì§€ ì„¤ëª…í•´ ë‹¬ë¼ëƒ¥.")
    
    prompt = st.text_input("ì–´ë–¤ ê·¸ë¦¼ì„ ì›í•˜ëŠ”ì§€ ì„¤ëª…í•´ë‹¬ë¼ ëƒ¥..")
    
    if prompt:
        if "api_key" in st.session_state:
            image_url = get_dalle_image(st.session_state["api_key"], prompt)
            st.image(image_url, caption="Generated by DALL-E", use_column_width=True)
        else:
            st.write("APIí‚¤ë¥¼ ê¹Œë¨¹ì€ê±° ì•„ë‹ˆëƒ¥..")
